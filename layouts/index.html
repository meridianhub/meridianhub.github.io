{{ define "main" }}
<article class="landing-page">
  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-content">
      <h1>Define how you charge.<br>The engine handles the rest.</h1>
      <p class="hero-subtext">
        Open-source billing engine with a double-entry ledger.
        Write your pricing and settlement logic in code &mdash;
        Meridian handles the bookkeeping, audit trails, and payment collection.
      </p>
      <div class="hero-cta">
        <a href="https://github.com/meridianhub/meridian" class="btn btn-primary" target="_blank" rel="noopener">
          View on GitHub
        </a>
        <a href="mailto:ben@meridianhub.org" class="btn btn-secondary">
          Become a Design Partner
        </a>
      </div>
    </div>
  </section>

  <!-- The Problem -->
  <section class="section pillar-section">
    <div class="section-content">
      <h2 class="pillar-title">The Problem</h2>
      <div class="pillar-content">
        <p class="stakes">
          Billing starts as a Stripe checkout and a cron job.
          Then you need usage metering. Then revenue splits.
          Then your auditor asks for a transaction trail.
          Then estimates need to reconcile with actuals.
        </p>
        <p class="proof">
          Now you're maintaining a financial system &mdash; and you're not a financial company.
          Meridian is the billing engine you'd build if you had a team of financial engineers.
        </p>
      </div>
    </div>
  </section>

  <!-- What You Get -->
  <section class="section pillar-section pillar-alt">
    <div class="section-content">
      <h2 class="pillar-title">What You Get</h2>
      <div class="solution-grid">
        <div class="solution-item">
          <h3>Bill</h3>
          <p>
            Define pricing rules, usage metering, and revenue splits in code.
            Saga orchestration means settlement completes or reverts &mdash; no orphaned charges.
          </p>
        </div>
        <div class="solution-item">
          <h3>Know</h3>
          <p>
            Every transaction recorded in a double-entry ledger with an immutable audit trail.
            When your auditor asks where the money went, you show them.
          </p>
        </div>
        <div class="solution-item">
          <h3>Collect</h3>
          <p>
            Stripe Connect integration handles multi-tenant payment collection.
            Reconciliation detects variances between expected and actual.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- How It Works -->
  <section id="how-it-works" class="section pillar-section">
    <div class="section-content">
      <h2 class="pillar-title">How It Works</h2>
      <div class="pillar-content">
        <p class="stakes">
          You write business logic in <a href="https://github.com/google/starlark-go" target="_blank" rel="noopener">Starlark</a>,
          a deterministic Python subset. No imports, no filesystem, no network &mdash;
          every script is guaranteed to terminate and produce the same result every time.
        </p>
      </div>
      <pre><code class="language-python">def charge_subscription(ctx):
    account = resolve_account(
        party_id=ctx.customer_id,
        org_id=ctx.org_id,
        currency="GBP",
    )
    post(account, ctx.amount, "DEBIT")
    record_receivable(account, ctx.amount, due_date=ctx.billing_date)

def distribute_revenue(ctx):
    for p in party.list_participants(ctx.org_id):
        share = party.get_structuring_data(p.id, ctx.org_id)["allocation_share"]
        account = resolve_account(party_id=p.id, org_id=ctx.org_id, currency="GBP")
        post(account, ctx.amount * Decimal(share), "CREDIT")</code></pre>

      <div class="arch-diagram">
        <pre class="mermaid">
sequenceDiagram
    participant Client as Your System
    participant Meridian as Meridian
    participant Bank as Payment Network

    Client->>Meridian: 1. Initiate Payment
    Note over Meridian: Validate & Reserve Funds
    Meridian->>Meridian: 2. Record Position
    Meridian->>Bank: 3. Execute Payment
    Bank-->>Meridian: Confirmation
    Meridian->>Meridian: 4. Post to Ledger
    Meridian-->>Client: 5. Complete

    Note over Client,Bank: If anything fails, automatic rollback
        </pre>
      </div>
    </div>
  </section>

  <!-- Built For Complex Billing -->
  <section class="section pillar-section pillar-alt">
    <div class="section-content">
      <h2 class="pillar-title">Built For Complex Billing</h2>
      <div class="solution-grid">
        <div class="solution-item">
          <h3>Usage Metering</h3>
          <p>Ingest events, apply pricing rules, produce invoices. Handle time-of-use rates and tiered pricing.</p>
        </div>
        <div class="solution-item">
          <h3>Revenue Splits</h3>
          <p>Multi-party settlement with automatic distribution. Each participant gets their share, every time.</p>
        </div>
        <div class="solution-item">
          <h3>Estimates &rarr; Actuals</h3>
          <p>Bi-temporal data tracks what you knew and when. Reconcile forecasts against meter reads without re-running history.</p>
        </div>
        <div class="solution-item">
          <h3>Multi-Asset</h3>
          <p>Currency, kilowatt-hours, carbon credits, compute hours. Same ledger, same rigour, any unit of value.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Source Available -->
  <section class="section pillar-section">
    <div class="section-content">
      <h2 class="pillar-title">Source Available</h2>
      <div class="pillar-content">
        <p class="stakes">
          Business Source License 1.1. Use, modify, and deploy for any internal purpose.
          Converts to Apache 2.0 on February 12, 2030.
        </p>
        <p class="proof">
          Go &bull; Protocol Buffers + gRPC &bull; CockroachDB &bull; Apache Kafka &bull; Kubernetes &bull; Stripe Connect
        </p>
      </div>
      <div class="hero-cta">
        <a href="https://github.com/meridianhub/meridian" class="btn btn-primary" target="_blank" rel="noopener">
          Read the Source
        </a>
        <a href="https://github.com/meridianhub/meridian/tree/develop/docs/adr" class="btn btn-secondary" target="_blank" rel="noopener">
          Architecture Decisions
        </a>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section class="section contact-section">
    <div class="section-content">
      <h2>Looking for Design Partners</h2>
      <p class="hero-subtext">
        Meridian is in active development. Core ledger, saga orchestration, and Stripe Connect are implemented.
        We're looking for companies with complex billing to build with.
      </p>
      <div class="hero-cta">
        <a href="mailto:ben@meridianhub.org" class="btn btn-primary">
          Get in Touch
        </a>
      </div>
    </div>
  </section>
</article>
{{ end }}
